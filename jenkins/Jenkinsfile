pipeline{
    agent any

    environment {
            // Set JAVA_HOME to the path of Java 17
            JAVA_HOME = '/usr/local/opt/openjdk@17'
        }

    stages{

        stage('Checkout') {
            steps {
                checkout([$class: 'GitSCM', branches: [[name: '*/main']], userRemoteConfigs: [[url: 'https://github.com/thunderxx2/greenmarket.git']]])
            }
        }

    stage('Build') {
        steps {
            sh './gradlew clean assembleDebug'
        }
    }

    stage('Test'){
        steps{
            sh './gradlew test'
        }
    }

    stage('Publish APK'){
        steps{
            archiveArtifacts artifacts: 'app/build/outputs/apk/debug/*.apk', fingerprint: true
        }
    }

//     stage('Deploy'){
//         steps {
//             //
//         }
//     }
  }

      post {
        always {
          cleanWs()
          }
      }
}